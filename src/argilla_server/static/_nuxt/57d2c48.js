(window.webpackJsonp=window.webpackJsonp||[]).push([[242,245],{1100:function(e,t,a){"use strict";a.r(t),a.d(t,"useDatasetViewModel",(function(){return s}));a(17);var r=a(91),i=a(46),n=a(289),s=function useDatasetViewModel(){var e=Object(r.d)(!1),t=Object(r.h)().value.params.id;return{datasetId:t,isLoadingDataset:e,handleError:function handleError(e){var a="";switch(e){case n.a.ERROR_FETCHING_DATASET_INFO:a="Can't get dataset info for dataset_id: ".concat(t);break;case n.a.ERROR_FETCHING_WORKSPACE_INFO:a="Can't get workspace info for dataset_id: ".concat(t);break;default:a="There was an error on fetching dataset info and workspace info. Please try again"}var r={message:a,numberOfChars:a.length,type:"error"};i.a.dispatch("notify",r)},createRootBreadCrumbs:function createRootBreadCrumbs(e){return[{link:{name:"datasets"},name:"Home"},{link:{path:"/datasets?workspaces=".concat(e.workspace)},name:e.workspace},{link:{path:"annotation-mode"},name:e.name}]}}}},1472:function(e,t,a){"use strict";a.r(t),a.d(t,"useAnnotationModeViewModel",(function(){return b}));a(12),a(6),a(70);var r=a(91),i=a(22),n=a(1100),s=a(307),u=a(303),o=a(1),c=a(2),l=(a(233),a(63),a(14)),m=a(31),h=a(11),f=(a(30),a(37),a(121),function(){function Criteria(){Object(o.a)(this,Criteria),this.reset()}return Object(c.a)(Criteria,[{key:"getRangeValue",value:function getRangeValue(e){var t=e.match(/ge(-?\d+(\.\d+)?)\.le(-?\d+(\.\d+)?)/);if(t)return{ge:Number(t[1]),le:Number(t[3])}}},{key:"isEqual",value:function isEqual(e){return this.urlParams===e.urlParams}}]),Criteria}());function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var a,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Object(m.a)(this,a)}}var v=function(e){Object(l.a)(SimilarityCriteria,e);var t=_createSuper(SimilarityCriteria);function SimilarityCriteria(){return Object(o.a)(this,SimilarityCriteria),t.apply(this,arguments)}return Object(c.a)(SimilarityCriteria,[{key:"complete",value:function complete(e){if(e){var t=e.split(".");8===t.length&&(this.recordId=t[1],this.vectorName=t[3],this.limit=parseInt(t[5]),this.order=t[7])}}},{key:"withValue",value:function withValue(e,t,a,r){(e||t||a||r)&&(this.recordId=e,this.vectorName=t,this.limit=a,this.order=r)}},{key:"isCompleted",get:function get(){return void 0!==this.recordId&&void 0!==this.vectorName&&void 0!==this.limit&&void 0!==this.order}},{key:"urlParams",get:function get(){return this.isCompleted?"record.".concat(this.recordId,".vector.").concat(this.vectorName,".limit.").concat(this.limit,".order.").concat(this.order):""}},{key:"reset",value:function reset(){this.recordId=void 0,this.vectorName=void 0,this.limit=50,this.order="most"}}]),SimilarityCriteria}(f),p=a(13);a(23),a(24),a(69),a(17);function SortCriteria_createSuper(e){var t=function SortCriteria_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var a,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Object(m.a)(this,a)}}var d=function(e){Object(l.a)(SortCriteria,e);var t=SortCriteria_createSuper(SortCriteria);function SortCriteria(){var e;return Object(o.a)(this,SortCriteria),(e=t.apply(this,arguments)).value=[],e}return Object(c.a)(SortCriteria,[{key:"complete",value:function complete(e){var t=this;e&&e.split("~").forEach((function(e){var a=t.parseUrlParams(e);t.value.push(a)}))}},{key:"witValue",value:function witValue(e){this.value=e.map((function(e){return Object.assign({},e)}))}},{key:"reset",value:function reset(){this.value=[]}},{key:"isCompleted",get:function get(){return this.value.length>0}},{key:"urlParams",get:function get(){return this.isCompleted?this.value.map((function(e){return e.property?"".concat(e.entity,".").concat(e.name,".").concat(e.property,".").concat(e.order):"".concat(e.entity,".").concat(e.name,".").concat(e.order)})).join("~"):""}},{key:"parseUrlParams",value:function parseUrlParams(e){var t=e.split("."),a=Object(p.a)(t,4),r=a[0],i=a[1],n=a[2],s=a[3];return n&&s?{entity:r,name:i,order:s,property:n}:{entity:r,name:i,order:n}}}]),SortCriteria}(f);a(48);function MetadataCriteria_createSuper(e){var t=function MetadataCriteria_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var a,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Object(m.a)(this,a)}}var g=function(e){Object(l.a)(MetadataCriteria,e);var t=MetadataCriteria_createSuper(MetadataCriteria);function MetadataCriteria(){var e;return Object(o.a)(this,MetadataCriteria),(e=t.apply(this,arguments)).value=[],e}return Object(c.a)(MetadataCriteria,[{key:"complete",value:function complete(e){var t=this;e&&e.split("~").forEach((function(e){var a=e.split("."),r=Object(p.a)(a,1)[0],i=t.getRangeValue(e);if(i)t.value.push({name:r,value:{ge:i.ge,le:i.le}});else{var n=e.split(".").slice(1);t.value.push({name:r,value:n})}}))}},{key:"withValue",value:function withValue(e){this.value=e.map((function(e){return{name:e.name,value:e.value}}))}},{key:"reset",value:function reset(){this.value=[]}},{key:"isCompleted",get:function get(){return this.value.length>0}},{key:"urlParams",get:function get(){return this.isCompleted?this.value.map((function(e){var t=e.value;if("ge"in t&&"le"in t)return"".concat(e.name,".ge").concat(t.ge,".le").concat(t.le);var a=e.value;return"".concat(e.name,".").concat(a.map((function(e){return e})).join("."))})).join("~"):""}}]),MetadataCriteria}(f);function ResponseCriteria_createSuper(e){var t=function ResponseCriteria_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var a,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Object(m.a)(this,a)}}var y=function(e){Object(l.a)(ResponseCriteria,e);var t=ResponseCriteria_createSuper(ResponseCriteria);function ResponseCriteria(){var e;return Object(o.a)(this,ResponseCriteria),(e=t.apply(this,arguments)).value=[],e}return Object(c.a)(ResponseCriteria,[{key:"complete",value:function complete(e){var t=this;e&&e.split("~").forEach((function(e){var a=e.split("."),r=Object(p.a)(a,1)[0],i=t.getRangeValue(e);if(i)t.value.push({name:r,value:{ge:i.ge,le:i.le}});else{var n=e.split(".").slice(1);t.value.push({name:r,value:n})}}))}},{key:"withValue",value:function withValue(e){this.value=e.map((function(e){return{name:e.name,value:e.value}}))}},{key:"reset",value:function reset(){this.value=[]}},{key:"isCompleted",get:function get(){return this.value.length>0}},{key:"urlParams",get:function get(){return this.isCompleted?this.value.map((function(e){var t=e.value;if("ge"in t&&"le"in t)return"".concat(e.name,".ge").concat(t.ge,".le").concat(t.le);var a=e.value;return"".concat(e.name,".").concat(a.map((function(e){return e})).join("."))})).join("~"):""}}]),ResponseCriteria}(f),C=a(169);a(286),a(287),a(27),a(29),a(88);function SuggestionCriteria_createSuper(e){var t=function SuggestionCriteria_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var a,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Object(m.a)(this,a)}}var k=function(e){Object(l.a)(SuggestionCriteria,e);var t=SuggestionCriteria_createSuper(SuggestionCriteria);function SuggestionCriteria(){var e;return Object(o.a)(this,SuggestionCriteria),(e=t.apply(this,arguments)).value=[],e}return Object(c.a)(SuggestionCriteria,[{key:"complete",value:function complete(e){var t=this;e&&e.split("~").forEach((function(e){var a=e.split("."),r=Object(C.a)(a),i=r[0],n=r[1],s=r.slice(2);if("score"===n||"value"===n){var u=t.getRangeValue(e);if(u){var o={name:n,value:{ge:u.ge,le:u.le}};return t.addConfiguration(i,o)}}if("value"===n){var c="operator"===s[0]?s[1]:void 0,l={name:n,value:{operator:c,values:c?s.slice(3):s.slice(1)}};return t.addConfiguration(i,l)}if("agent"===n){var m={name:n,value:s};return t.addConfiguration(i,m)}}))}},{key:"withValue",value:function withValue(e){this.value=e.map((function(e){return{name:e.name,value:e.value}}))}},{key:"reset",value:function reset(){this.value=[]}},{key:"isCompleted",get:function get(){return this.value.length>0}},{key:"urlParams",get:function get(){return this.isCompleted?this.value.flatMap((function(e){return e.value.map((function(t){var a=t.value;if("ge"in a&&"le"in a)return"".concat(e.name,".").concat(t.name,".ge").concat(a.ge,".le").concat(a.le);var r=t.value;if("operator"in r&&r)return"".concat(e.name,".").concat(t.name,".operator.").concat(r.operator,".values.").concat(r.values.join("."));if("values"in r&&r.values)return"".concat(e.name,".").concat(t.name,".values.").concat(r.values.join("."));var i=t.value;return"".concat(e.name,".").concat(i.join("."))}))})).join("~"):""}},{key:"or",get:function get(){return this.isCompleted?this.value.filter((function(e){return e.value.some((function(e){return"and"!==e.value.operator}))})).flatMap((function(e){return e.value.map((function(t){return{question:{name:e.name},configuration:{name:t.name,value:t.value}}}))})):[]}},{key:"and",get:function get(){return this.isCompleted?this.value.filter((function(e){return e.value.some((function(e){return"and"===e.value.operator}))})).flatMap((function(e){return e.value.filter((function(e){return"value"===e.name})).flatMap((function(t){return t.value.values.map((function(a){return{question:{name:e.name},configuration:{name:t.name,value:a}}}))}))})):[]}},{key:"addConfiguration",value:function addConfiguration(e,t){var a=this.value.find((function(t){return t.name===e}));a?a.value.push(t):this.value.push({name:e,value:[t]})}}]),SuggestionCriteria}(f),S=function(){function RecordCriteria(e,t,a,r,i,n,s,u,c){Object(o.a)(this,RecordCriteria),this.datasetId=e,this.page=t,this.status=a,this.searchText=r,this.isChangingAutomatically=!1,this.metadata=new g,this.sortBy=new d,this.response=new y,this.suggestion=new k,this.similaritySearch=new v,this.complete(t,a,r,i,n,s,u,c),this.commit()}return Object(c.a)(RecordCriteria,[{key:"isFilteringByText",get:function get(){return this.searchText.length>0}},{key:"isFilteringBySimilarity",get:function get(){return this.similaritySearch.isCompleted}},{key:"isFilteringByResponse",get:function get(){return this.response.isCompleted}},{key:"isFilteringBySuggestion",get:function get(){return this.suggestion.isCompleted}},{key:"isFilteringByMetadata",get:function get(){return this.metadata.isCompleted}},{key:"isSortingBy",get:function get(){return this.sortBy.isCompleted}},{key:"isFilteringByAdvanceSearch",get:function get(){return this.isFilteringByText||this.isFilteringByMetadata||this.isFilteringBySimilarity||this.isFilteringByResponse||this.isFilteringBySuggestion||this.isSortingBy}},{key:"isFilteredByText",get:function get(){return this.committed.searchText.length>0}},{key:"isFilteredByMetadata",get:function get(){return this.committed.metadata.isCompleted}},{key:"isFilteredByResponse",get:function get(){return this.committed.response.isCompleted}},{key:"isFilteredBySuggestion",get:function get(){return this.committed.suggestion.isCompleted}},{key:"isSortedBy",get:function get(){return this.committed.sortBy.isCompleted}},{key:"isFilteredBySimilarity",get:function get(){return this.committed.similaritySearch.isCompleted}},{key:"hasChanges",get:function get(){return this.committed.page!==this.page||(this.committed.status!==this.status||(this.committed.searchText!==this.searchText||(!this.metadata.isEqual(this.committed.metadata)||(!this.sortBy.isEqual(this.committed.sortBy)||(!this.response.isEqual(this.committed.response)||(!this.suggestion.isEqual(this.committed.suggestion)||!this.similaritySearch.isEqual(this.committed.similaritySearch)))))))}},{key:"complete",value:function complete(e,t,a,r,i,n,s,u){this.isChangingAutomatically=!0,this.page=Number(null!=e?e:1),this.status=null!=t?t:"pending",this.searchText=null!=a?a:"",this.metadata.complete(r),this.sortBy.complete(i),this.response.complete(n),this.suggestion.complete(s),this.similaritySearch.complete(u)}},{key:"commit",value:function commit(){var e=new v,t=new g,a=new d,r=new y,i=new k;e.withValue(this.similaritySearch.recordId,this.similaritySearch.vectorName,this.similaritySearch.limit,this.similaritySearch.order),t.withValue(this.metadata.value),a.witValue(this.sortBy.value),r.withValue(this.response.value),i.withValue(this.suggestion.value),this.committed={page:this.page,status:this.status,searchText:this.searchText,metadata:t,sortBy:a,response:r,suggestion:i,similaritySearch:e},this.isChangingAutomatically=!1}},{key:"rollback",value:function rollback(){this.page=this.committed.page,this.status=this.committed.status,this.searchText=this.committed.searchText,this.metadata=this.committed.metadata,this.metadata.withValue(this.committed.metadata.value),this.sortBy.witValue(this.committed.sortBy.value),this.response.withValue(this.committed.response.value),this.suggestion.withValue(this.committed.suggestion.value),this.similaritySearch.withValue(this.committed.similaritySearch.recordId,this.committed.similaritySearch.vectorName,this.committed.similaritySearch.limit,this.committed.similaritySearch.order)}},{key:"reset",value:function reset(){this.metadata.reset(),this.sortBy.reset(),this.response.reset(),this.suggestion.reset()}},{key:"nextPage",value:function nextPage(){this.page=this.committed.page+1}},{key:"previousPage",value:function previousPage(){this.page=this.committed.page-1}}]),RecordCriteria}(),R=a(283),__awaiter=function(e,t,a,r){return new(a||(a=Promise))((function(i,n){function fulfilled(e){try{step(r.next(e))}catch(e){n(e)}}function rejected(e){try{step(r.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof a?e:new a((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},b=function useAnnotationModeViewModel(){var e=Object(r.i)(),t=Object(R.e)(),a=Object(u.a)().state,o=Object(i.useResolve)(s.a),c=Object(n.useDatasetViewModel)(),l=c.datasetId,m=c.isLoadingDataset,h=c.handleError,f=c.createRootBreadCrumbs,v=Object(r.a)((function(){return f(a)})),p=Object(r.d)(new S(l,t.getQueryParams("_page"),t.getQueryParams("_status"),t.getQueryParams("_search"),t.getQueryParams("_metadata"),t.getQueryParams("_sort"),t.getQueryParams("_response"),t.getQueryParams("_suggestion"),t.getQueryParams("_similarity")));t.watchBrowserNavigation((function(){p.value.complete(t.getQueryParams("_page"),t.getQueryParams("_status"),t.getQueryParams("_search"),t.getQueryParams("_metadata"),t.getQueryParams("_sort"),t.getQueryParams("_response"),t.getQueryParams("_suggestion"),t.getQueryParams("_similarity"))}));return Object(r.c)((function(){!function loadDataset(){__awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,m.value=!0,t.next=4,o.execute(l);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),h(t.t0.response),e.push("/");case 10:return t.prev=10,m.value=!1,t.finish(10);case 13:case"end":return t.stop()}}),_callee2,null,[[0,6,10,13]])})))}()})),{isLoadingDataset:m,recordCriteria:p,dataset:a,datasetId:l,breadcrumbs:v,updateQueryParams:function updateQueryParams(){return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setQueryParams({key:"_page",value:p.value.committed.page.toString()},{key:"_status",value:p.value.committed.status},{key:"_search",value:p.value.committed.searchText},{key:"_metadata",value:p.value.committed.metadata.urlParams},{key:"_sort",value:p.value.committed.sortBy.urlParams},{key:"_response",value:p.value.committed.response.urlParams},{key:"_suggestion",value:p.value.committed.suggestion.urlParams},{key:"_similarity",value:p.value.committed.similaritySearch.urlParams});case 2:case"end":return e.stop()}}),_callee)})))}}}}}]);